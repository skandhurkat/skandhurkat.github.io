<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Skand Hurkat</title>
    <link>https://skandhurkat.com/post/</link>
    <description>Recent content in Posts on Skand Hurkat</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator>
    <language>en-us</language>
    <copyright>&amp;copy; {year} Skand Hurkat. All rights reserved.</copyright>
    <lastBuildDate>Sun, 01 Jan 2017 00:00:00 +0000</lastBuildDate>
    
	    <atom:link href="https://skandhurkat.com/post/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Star Trek 2019</title>
      <link>https://skandhurkat.com/post/star-trek-2019/</link>
      <pubDate>Fri, 12 Apr 2019 21:10:31 -0700</pubDate>
      
      <guid>https://skandhurkat.com/post/star-trek-2019/</guid>
      <description>&lt;p&gt;2019 marks a few anniversaries. It is the 50&lt;sup&gt;th&lt;/sup&gt; anniversary
of the moon landings. It also marks fifty years since the end of Gene
Roddenberry&amp;rsquo;s Star Trek (the original series).&lt;/p&gt;
&lt;p&gt;As a bit of a Trek nerd myself, I figured that this is a great time
to review the technology shown in all the Star Trek series, and see
how close we are to the universe imagined by Roddenberry.&lt;/p&gt;
&lt;h2 id=&#34;interstellar-travel&#34;&gt;Interstellar Travel&lt;/h2&gt;
&lt;p&gt;Interstellar travel is the central premise in Star Trek, and serves
as the platform upon which stories are told. Unfortunately,
interstellar travel still remains the domain of science fiction. A
month after &amp;ldquo;Turnabout Intruder&amp;rdquo; aired, Neil Armstrong set foot on
the moon. Since then, humanity hasn&amp;rsquo;t really travelled all that far,
although our creations since then are hurtling through space, beyond
our solar system into interstellar space, carrying upon them little
plaques and records that would hardly be adequate to convey the sense
of life on earth. Send more Chuck Berry.&lt;/p&gt;
&lt;p&gt;Warping the universe to travel faster than the speed of light,
however, seems out of the realm of possibility for the foreseeable
future.&lt;/p&gt;
&lt;h2 id=&#34;transporters&#34;&gt;Transporters&lt;/h2&gt;
&lt;p&gt;Surprisingly, we are closer to this than I imagined. It is possible
to use quantum entanglement to transfer information across a
distance, and it is possible that a system using a very large number
of entangled particles may at some point be able to transfer a
massive object over a distance. At the moment, a group of scientists
in China have &lt;a href=&#34;https://arxiv.org/abs/1707.00934&#34;&gt;claimed that they were able to teleport a photon to a
satellite 300 km above the earth&lt;/a&gt;.
Are you ready to have yourself be destroyed, one subatomic particle
at a time, while being simultaneously recreated in another location in
the universe? You may have to wait a long time. Even if that does
become a reality, would you like to have yourself disintegrated
atom-by-atom as you&amp;rsquo;re scanned in one place, to be recreated in a
quantum-entangled state in another place? The process itself may be
an agonizing death.&lt;/p&gt;
&lt;h2 id=&#34;communicators&#34;&gt;Communicators&lt;/h2&gt;
&lt;p&gt;In 2006, I owned a Motorola Razr v3i. By the standards of modern
smartphones, it was a puny, underpowered thing, with just a 1
megapixel rear camera, a tiny screen, 256 MB SD card storage for
music, and GPRS/EDGE for internet. Yet, it exceeded the capabilities
of the original Star Trek communicators. Modern smartphones are a
marvel, so I&amp;rsquo;d say we have this in the bag. For the cosplayers
amongst you, someone has created a replica of the hero prop used in
the series, which is basically a hand-held bluetooth speakerphone
that can connect to your smartphone, if you would like to live with a
less-useful device than your smartphone. For those of you who like
The Next Generation more, Google has created a little communicator
pin.&lt;/p&gt;
&lt;p&gt;By the way, no modern smart phone has been able to capture the
emotional connection of owning a Motorola Razr. I wish someone would
bring it back for the sheer nostalgia.&lt;/p&gt;
&lt;h2 id=&#34;computers&#34;&gt;Computers&lt;/h2&gt;
&lt;p&gt;Back in the 60s, computers were these gigantic machines that really
didn&amp;rsquo;t have any UI, so to speak. They probably had large spinning
tape reels or drums, with blinkenlights as they processed data. Not
very TV friendly to show someone feeding in a stack of punch cards to
these machines. Star Trek did away with this by making their
computers entirely voice controlled. This was great for TV, as the
computer could have a personality. Arguably, now Siri, Alexa, the
Google assistant, Cortana, are all probably inspired by Star Trek
computers in some way or another. Try asking Cortana, &amp;ldquo;Beam me up
Scotty&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Computers today are so much more powerful than computers in the 60s.
A cellphone today probably has more computing power than all of NASA
did back in the 60s, yet, they were able to launch man to the moon.
As a computer engineer, I often wonder, where have all the cycles
gone?&lt;/p&gt;
&lt;p&gt;It is interesting to see the evolution of computers throughout the Star
Trek universe. The Original Series had these buttons and blinkenlights.
While most interactions were voice-driven, sometimes, we would see
either Kirk or Spock drop in a plastic card that looked suspiciously
like a futuristic punch card or cassette. I strongly suspect that the
voice interactions in the original series were, just like warp engines,
a way to work around the limitations of contemporary technology.
Computers in the 60s used punch cards, magnetic tape, and were tedious
to program, hardly the subject of gripping television. Voice
interactions made for much better storytelling.&lt;/p&gt;
&lt;p&gt;The Next Generation decided to go with the Okuda-gram touch interface
for all their computers, which is probably most familiar in today&amp;rsquo;s
world of touchscreen devices.  It&amp;rsquo;s crazy to think that college
undergraduates today have probably had all their computer interactions
via a touch screen, and much less with a keyboard and mouse, and almost
certainly never through a terminal. Voyager introduced the idea of
bio-neural gel packs, which were, apparently, biological neurons
suspended in a nutrient gel medium. Back in 2005, researchers at the
University of Florida &lt;a href=&#34;http://research.ufl.edu/publications/explore/v10n1/extract2.html&#34;&gt;used biological neurons suspended over a grid of
electrodes to control a flight
simulator&lt;/a&gt;,
in a technique not too different from the bio-neural gel packs in
Voyager. Today, the hottest topic appears to be deep learning, which is
just us wasting computer cycles trying to emulate neurons to solve hard
problems. Do you talk to any of your digital assistants?  You&amp;rsquo;re
interacting with a deep neural net. Search something on Bing?  Deep
neural net. Use machine translation? Deep neural net. Predictive text on
your phone keyboard? Deep neural net.&lt;/p&gt;
&lt;h2 id=&#34;universal-translators&#34;&gt;Universal Translators&lt;/h2&gt;
&lt;p&gt;Yet another storytelling device, universal translators allowed everyone
on the show to speak English, even the Firengi. Today, deep neural
networks translate our speech from one language to another on the fly,
in a device that fits within our pockets, connected to a device that
fits within our ear. Have any of you tried the live subtitles in
Powerpoint? The tool for poorly made slides can now transcribe and
translate, in real time, a presentation on any topic. The world has
never been smaller.&lt;/p&gt;
&lt;h2 id=&#34;tricorders&#34;&gt;Tricorders&lt;/h2&gt;
&lt;p&gt;Tricorders were devices that performed three functions &amp;ndash; sensor
scanning, data analysis, and recording. Arguably, our cellphones
today can do all three. So can our fitbits, and other wearables. My
phone knows from it&amp;rsquo;s accelerometer, GPS, barometer, compass, and
other sensor data whether I&amp;rsquo;m sitting down, walking, biking, or doing
any other activity. It also knows whether the phone is on my body, or
is resting on a desk somewhere. &lt;a href=&#34;https://support.microsoft.com/en-us/help/4028111/windows-lock-your-windows-10-pc-automatically-when-you-step-away-from&#34;&gt;My computer knows if I&amp;rsquo;ve walked
away and locks itself
automatically.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Medical tricorders are also closer than one may think. Since the
technology has evolved gradually, we don&amp;rsquo;t see devices such as
fitbits, pulse oximeters, blood glucose monitors, blood pressure
monitors as tricorders, they generally perform just one task.
However, Qualcomm and X-Prize teamed up to offer a 10 million dollar
prize for a device that can diagnose more than 15 medical conditions
better than a panel of certified physicians. Although no team won the
prize, it is only a matter of time before we have true medical
tricorders, they are a necessity.&lt;/p&gt;
&lt;h2 id=&#34;dna-data-storage&#34;&gt;DNA Data Storage&lt;/h2&gt;
&lt;p&gt;Multiple Star Trek TNG episodes featured plot lines involving DNA data
storage. &amp;ldquo;The Chase&amp;rdquo; featured a plot where a program is hidden in our
DNA.  In &amp;ldquo;The Drumhead&amp;rdquo;, a Klingon officer hides secret information in
protein sequences in his blood as a technique of spy craft.&lt;/p&gt;
&lt;p&gt;We&amp;rsquo;re closer to storing data in DNA than we would think. &lt;a href=&#34;https://www.microsoft.com/en-us/research/project/dna-storage/&#34;&gt;Researchers at
Microsoft and the University of Washington&lt;/a&gt; are
developing techniques that would allow us to store data in artificial
DNA strands. The new technology promises storage of up to one exabyte
per cubic millimeter with a half life of 500 years.&lt;/p&gt;
&lt;h2 id=&#34;holodecks&#34;&gt;Holodecks&lt;/h2&gt;
&lt;p&gt;TNG introduced us to holodecks, the magical black rooms with yellow
grids within the Starship that could become any place one wanted, as
long as it was programmed into the computer. Virtual and augmented
reality technology is as close to giving us the same experience as the
holodecks.&lt;/p&gt;
&lt;p&gt;One of the major issues with present day VR is that we&amp;rsquo;re confined to
the physical dimensions of whatever room we&amp;rsquo;re physically in. There is
some ongoing research in using X-Y treadmills to keep us in the same
physical space while we move around a virtual space, but this has its
limitations. The treadmills can only be reactive, moving us back to
where we started. At that point, the accelerometers in our ears tell us
that something has gone wrong, and the immersion is broken.&lt;/p&gt;
&lt;p&gt;I wondered how Star Trek got around the confines of limited space on the
holodeck. As best I can tell, they never really answered the question. I
think that the light-matter holograms somehow moved under the feet of
the people in the holodeck, but that could easily be challenged if
everyone moved radially outwards in a simulation of flat terrain. In the
very first episode of TNG, Data showed Riker the extent of the holodeck
by throwing a holo-rock at the wall. Ah well, some things are best left
unexplained.&lt;/p&gt;
&lt;h2 id=&#34;data&#34;&gt;Data&lt;/h2&gt;
&lt;p&gt;Speaking of Data, we&amp;rsquo;re nowhere near the level of sophistication that we
require for creating, what is essentially an artificial life form. Our
robotics are woefully inadequate in even the basic kinematics that are
essential for bipedal motion, although &lt;a href=&#34;https://youtu.be/_sBBaNYex3E&#34;&gt;Boston Dynamics has done some
incredible work in that field&lt;/a&gt;. Enjoy &lt;a href=&#34;https://youtu.be/g0TaYhjpOfo&#34;&gt;this
compilation&lt;/a&gt; of robots falling over at various
competitions.&lt;/p&gt;
&lt;h2 id=&#34;subspace-channels&#34;&gt;Subspace Channels&lt;/h2&gt;
&lt;p&gt;Another effective storytelling technique, subspace communications allow
for real-time video calling between our hero, the captain, and some
shadowy admiral with a hidden agenda. These require an even greater leap
of faith than warp engines, because we know that no signals can travel
faster than the speed of light. Even if we developed an incredibly
powerful engine that could literally &lt;em&gt;bend the universe&lt;/em&gt;, transmitting
signals in real time across a galaxy would require even more energy.
Battles in space would actually be very much like old naval battles
before the invention of radio. Communication would be slow, and news of
a battle could never make it back to headquarters.&lt;/p&gt;
&lt;h2 id=&#34;automatic-doors&#34;&gt;Automatic Doors&lt;/h2&gt;
&lt;p&gt;Strange as it may sound, automatic doors seemed like an impossibility
when the original series aired. The automatic doors were actually
stage-hands who received cues to open and close the doors. Sometimes,
they missed a cue, which lead to an actor walking through a closed door.
Today automatic doors are so ubiquitous, I marvel at the fact that they
didn&amp;rsquo;t exist when the series was made.&lt;/p&gt;
&lt;h2 id=&#34;hyposprays&#34;&gt;Hyposprays&lt;/h2&gt;
&lt;p&gt;The magical injections that doctors used in Star Trek (possibly to be
compassionate to the poor actors whose characters needed injections
multiple times in each episode) are very close to being a real thing.
Researchers at MIT have developed a &lt;a href=&#34;https://news.mit.edu/2012/needleless-injections-0524&#34;&gt;Lorentz force
actuator&lt;/a&gt; that injects drugs at high velocity into a
patient without the use of needles.&lt;/p&gt;
&lt;h2 id=&#34;other-technology&#34;&gt;Other Technology&lt;/h2&gt;
&lt;p&gt;Star Trek brought us so much technology, it is hard to list all of it in
a single blog post. We haven&amp;rsquo;t even touched long-range scanners,
replicators (3D printers today), phasors, tractor beams, force fields,
shields, gravplating, cloaking devices, time travel, and many others.
Star Trek was groundbreaking, not just in the technology it showcased,
but more in the message it delivered. By distancing ourselves from alien
cultures light years away, it allowed us the opportunity to observe our
own biases and prejudices, laying it all in the open, criticizing us for
our narrow-mindedness. Arguably, it made us all better people. And that
is what fifty years of Star Trek is all about.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Introduction to CMake</title>
      <link>https://skandhurkat.com/post/intro-to-cmake/</link>
      <pubDate>Thu, 23 Nov 2017 16:28:40 -0500</pubDate>
      
      <guid>https://skandhurkat.com/post/intro-to-cmake/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://skandhurkat.com/&#34;&gt;CMake&lt;/a&gt; is cross-platform build and configuration system
for C and C++ code, which also happens to be my favourite build system.
In this post, I&amp;rsquo;ll present a quick tutorial on getting started with
CMake.&lt;/p&gt;
&lt;p&gt;But before we do, let&amp;rsquo;s start with an example of why other build systems
such as Makefiles don&amp;rsquo;t necessarily cut it. Actually, Makefiles work
fairly well, but writing Makefiles by hand is generally a pain in the
neck. In &lt;a href=&#34;https://skandhurkat.com/post/makefile-dependencies/&#34;&gt;a previous post&lt;/a&gt;,
I described how to write Makefiles that take include file dependencies
into account. If that post did not convince you that writing Makefiles
is hard, let me show you another example of a terrible Makefile and hope
that it scares you into never looking at a Makefile again. (This
Makefile was actually part of a project that was handed over to me, I
had to go over tonnes of other people&amp;rsquo;s code with comments written in
non-ascii characters in a language that wasn&amp;rsquo;t English, so I clearly
don&amp;rsquo;t have fond memories of this particular project.)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-Makefile&#34; data-lang=&#34;Makefile&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## Compiler + Linker
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;CC &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; g++
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LD &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; g++
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## external .h files to bring in
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;EXTRA_INCLUDES &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CCFLAGS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -g -Wno-deprecated -I/opt/local/include/ -I/opt/local/include/opencv/ -I./GMM/ -I./MaxFlow/ -I./MeanShift/ 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LDFLAGS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -L/opt/local/lib
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#LIBS = -lcv -lcxcore -lhighgui -lcvaux #-lml 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# for macs
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;LIBS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -lopencv_core -lopencv_highgui &lt;span style=&#34;color:#75715e&#34;&gt;#-lcvaux -lml &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## sources
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;CCFILES_GMM &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#### Some files&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CCFILES_MAXFLOW &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#### Some more files&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CCFILES_MEANSHIFT &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#### Holy shit, even more files&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CCFILES &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CCFILES_GMM&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CCFILES_MAXFLOW&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CCFILES_MEANSHIFT&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#### And even more files&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PROGFILE &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; main.cpp &lt;span style=&#34;color:#75715e&#34;&gt;#### Seriously, how many files?&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## object compilation
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;PROGOBJS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CCFILES:.cpp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;.o&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROGFILE:.cpp&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;.o&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## binary compilation
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;PROG &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BOO
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;all&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	@echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-&amp;gt; Building &lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROG&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; executable...&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#	@make .cpp.o
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	@make &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROG&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;.cpp.o&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CCFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;EXTRA_INCLUDES&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -c -o $@ $^
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#$(PROGOBJS):
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#	$(CC) $(CCFLAGS) $(EXTRA_INCLUDES) -c -o $@ $^
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;$(PROG)&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROGOBJS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;LD&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;LDFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;LIBS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROGOBJS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -o &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROG&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#$(PROGOBJS) $(LDFLAGS) $(LIBS)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#$(PROG): $(CCFILES)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#	$(CC) $(CCFLAGS) $(EXTRA_INCLUDES) $(LDFLAGS) $(LIBS) -o $@ $^
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;clean&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	@echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-&amp;gt; Cleaning...&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	rm -f &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROG&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;PROGOBJS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;There&amp;rsquo;s just so much to hate about this Makefile. First, it is almost
unreadable. Second, it does not account for any header file
dependencies. In fact, if any of the header files change, there&amp;rsquo;s no way
for the system to detect this at all, forcing the user to type in &lt;code&gt;make clean&lt;/code&gt;, then &lt;code&gt;make&lt;/code&gt; to make everything all over again. Third, given the
sheer number of files, make will take minutes to run, which kills
productivity. Fourth, if you look closely at the path, you will observe
that the person writing this Makefile used a Mac with MacPorts and
therefore is the kind of person who is just wrong. Fifth, this Makefile
obviously won&amp;rsquo;t work for someone on Linux or Windows, even worse, it
won&amp;rsquo;t work for another Mac user who used HomeBrew or compiled OpenCV
from source. Sixth, some rules are just commented out, which indicates
sloppy behaviour. Writing Makefiles like this just sucks. It sucks
productivity and makes me think of slow and painful death.&lt;/p&gt;
&lt;p&gt;The first thing I did when I was handed this project was to fix the
build system, and CMake came to the rescue here. I&amp;rsquo;ll now show how I
replaced this terrible Makefile with a clean, modular CMake build system
that replicated the effects of the Makefile (without the bugs, of course
&amp;#x1f604;). Hopefully, the ease of setting up this CMake system will
convince you to never write a Makefile again.&lt;/p&gt;
&lt;p&gt;As a dive into CMake, let&amp;rsquo;s start with a simple &amp;lsquo;Hello World&amp;rsquo; program.
The &lt;code&gt;helloworld.cc&lt;/code&gt; file contains the following code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C++&#34; data-lang=&#34;C++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello World&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To compile this code, create a file called &lt;code&gt;CMakeLists.txt&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-CMake&#34; data-lang=&#34;CMake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;add_executable(&lt;span style=&#34;color:#e6db74&#34;&gt;hello&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;helloworld.cc&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now, assuming that you are running on Linux or Mac OS terminal
(something with bash), you can execute the following commands:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mkdir build;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd build;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cmake ..;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;make;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This code creates a directory called build inside the project directory.
(An important point to note is that CMake always builds &amp;lsquo;out of source&amp;rsquo;,
i.e. the build directory must be a distinct directory from the source
directory.) It then switches to the build directory, executes CMake,
which creates Makefiles (turns out that there is no escaping Makefiles
after all&amp;hellip; &amp;#x1f601;) that have all the necessary information. As these
files are generated by a tool and not written by a person, you never
have to read them, so Makefile readability is not a concern.  Second,
the Makefiles encode all the dependencies correctly, so there&amp;rsquo;s no
reason to go through the hoops creating complex dependency files.&lt;/p&gt;
&lt;p&gt;&amp;lsquo;But what if I&amp;rsquo;m on Windows, or if I just am the kind of person who is
always wrong and uses CodeBlocks, Xcode, or another IDE?&amp;rsquo; you ask. Well,
hold on till the end, I&amp;rsquo;ll show you how CMake has you covered.&lt;/p&gt;
&lt;p&gt;Anyway, back to our hypothetical, but totally real project. The project
has multiple source files in different directories.&lt;/p&gt;
&lt;dl&gt;
&lt;dt&gt;GMM&lt;/dt&gt;
&lt;dd&gt;contains files that implement a Gaussian mixture models code.&lt;/dd&gt;
&lt;dt&gt;MAXFLOW&lt;/dt&gt;
&lt;dd&gt;contains files for max-flow graph cuts.&lt;/dd&gt;
&lt;dt&gt;MEANSHIFT&lt;/dt&gt;
&lt;dd&gt;contains files for mean shift (cluster analysis).&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;All these codes are independent, so could be made into libraries. Of
course, actually packaging this code as independent libraries is a
terrible idea because the code isn&amp;rsquo;t well written in the first place.
However, I don&amp;rsquo;t see too much harm in creating a static library that
will probably never be distributed for code in each of these
directories.&lt;/p&gt;
&lt;p&gt;We can create a &lt;code&gt;CMakeLists.txt&lt;/code&gt; file for each of these folders. The
CMakeLists will contain code that looks like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-CMake&#34; data-lang=&#34;CMake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;add_library(&lt;span style=&#34;color:#75715e&#34;&gt;# Library name
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;STATIC&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# Need to create a static library, not a shared one.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;### List of files
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then the top-level CMakeLists.txt can include these directories through
the simple command:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-CMake&#34; data-lang=&#34;CMake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Tell CMake to look into subdirectories for CMakeLists.txt files.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;subdirs(&lt;span style=&#34;color:#e6db74&#34;&gt;GMM&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MAXFLOW&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MEANSHIFT&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Add these directories to the compiler search path for include files.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# ${PROJECT_SOURCE_DIR} is the path to the source code in the project.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;include_directories(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_SOURCE_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/GMM&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_SOURCE_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/MAXFLOW&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_SOURCE_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/MEANSHIFT&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Okay, but we also notice that the top-level program &lt;code&gt;PROG&lt;/code&gt; needs OpenCV
in order to compile. CMake provides a very easy method to search for
dependencies. In the top-level &lt;code&gt;CMakeLists.txt&lt;/code&gt;, we add&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-CMake&#34; data-lang=&#34;CMake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;find_package(&lt;span style=&#34;color:#e6db74&#34;&gt;OpenCV&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;REQUIRED&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When we compile the program &lt;code&gt;PROG&lt;/code&gt;, we need to link it against the
OpenCV libraries, as well as the static libraries in the GMM, MAXFLOW,
MEANSHIFT folders.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-CMake&#34; data-lang=&#34;CMake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;include_directories(&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;OpenCV_INCLUDE_DIRS&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;add_executable(&lt;span style=&#34;color:#e6db74&#34;&gt;PROG&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;PROG.cc&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;target_link_libraries(&lt;span style=&#34;color:#e6db74&#34;&gt;PROG&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;OpenCV_LIBS&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;GMM&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MAXFLOW&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MEANSHIFT&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Putting it all together, the top-level &lt;code&gt;CMakeLists.txt&lt;/code&gt; contains the
following code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-CMake&#34; data-lang=&#34;CMake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Set a minimum version of CMake to be used, depending on the syntax of
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# the CMakeLists files.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;cmake_minimum_required(&lt;span style=&#34;color:#e6db74&#34;&gt;VERSION&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Give this project a cutsie name.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;project(&lt;span style=&#34;color:#e6db74&#34;&gt;PROG&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# CMake subdirectories to include for these libraries.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;subdirs(&lt;span style=&#34;color:#e6db74&#34;&gt;GMM&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MAXFLOW&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MEANSHIFT&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Search for OpenCV. If OpenCV is found, the command sets the
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# ${OpenCV_INCLUDE_DIR} and ${OpenCV_LIBS} variables to appropriate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# values. If OpenCV is not found, CMake will fail.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;find_package(&lt;span style=&#34;color:#e6db74&#34;&gt;OpenCV&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;REQUIRED&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Tell the compiler to search these directories for include files.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;include_directories(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_SOURCE_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/GMM&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_SOURCE_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/MAXFLOW&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_SOURCE_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/MEANSHIFT&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;OpenCV_INCLUDE_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Finally, create the executable that we want.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;add_executable(&lt;span style=&#34;color:#e6db74&#34;&gt;PROG&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;PROG.cc&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# And link it against the required libraries.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;target_link_libraries(&lt;span style=&#34;color:#e6db74&#34;&gt;prog&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;OpenCV_LIBS&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;GMM&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MAXFLOW&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;MEANSHIFT&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And we&amp;rsquo;re done! Isn&amp;rsquo;t this CMakeLists.txt file so much more readable
than the Makefile shown earlier? Not just that, this system will work
with any OS, any compiler, any platform. Isn&amp;rsquo;t this great?&lt;/p&gt;
&lt;p&gt;Okay, okay, you&amp;rsquo;re the kind that likes to do things in an IDE. CMake has
a concept of
&amp;lsquo;&lt;a href=&#34;//cmake.org/cmake/help/v3.0/manual/cmake-generators.7.html&#34;&gt;generators&lt;/a&gt;&amp;rsquo;,
which is just a fancy name for a backend. Still assuming that we are on
MacOS or Linux, we simply execute the following commands.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mkdir build;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd build;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cmake -G &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Xcode&amp;#34;&lt;/span&gt; .. &lt;span style=&#34;color:#75715e&#34;&gt;# Or CodeBlocks, or whatever.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;On Windows, execute the following commands on the command prompt
(assuming that CMake is on your path) to create a Visual Studio 2015
project.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-PowerShell&#34; data-lang=&#34;PowerShell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;md build
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cd build
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cmake -G &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Visual Studio 14&amp;#34;&lt;/span&gt; ..
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Oh, did I mention that CMake also has a nice GUI that makes this entire
process super easy? I won&amp;rsquo;t describe it here, I&amp;rsquo;ll just let you try it
out for yourself.&lt;/p&gt;
&lt;p&gt;The utility of CMake, however, doesn&amp;rsquo;t just end here. CMake has a very
neat testing system called CTest, which is something that I have
mentioned in &lt;a href=&#34;https://skandhurkat.com/post/intro-to-ctest/&#34;&gt;an earlier post&lt;/a&gt;.
This testing system interacts perfectly with a dashboard system called
CDash, that can quickly allow people to view test results. CTest/CDash
also has support for testing memory leaks and code coverage, so there.
Finally, the last piece of the puzzle is CPack, which is a way of
packaging software into installers.&lt;/p&gt;
&lt;p&gt;The next post in the series will probably deal with advanced CMake
configuration, including testing compiler versions, creating release and
debug configurations. Until next time&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Handling dependencies in Makefiles</title>
      <link>https://skandhurkat.com/post/makefile-dependencies/</link>
      <pubDate>Wed, 02 Aug 2017 17:45:00 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/makefile-dependencies/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve seen way too many projects that supply a makefile that requires the
user to run &lt;code&gt;make clean&lt;/code&gt; and &lt;code&gt;make&lt;/code&gt; every single time they make a
change to some file. This is annoying and error prone, and the good news
is that it can be easily solved with this one simple trick. Use a good
build-generation system like &lt;a href=&#34;https://skandhurkat.com/&#34;&gt;CMake&lt;/a&gt; instead.&lt;/p&gt;
&lt;p&gt;Still here? Well, since you asked, I shall tell.&lt;/p&gt;
&lt;p&gt;The trick is to have your compiler spit out a list of dependencies for
each source file.&lt;/p&gt;
&lt;p&gt;Try it out right now. Start a terminal and go to any project that is
sufficiently complex to have multiple include chains in a C or C++
source file (&lt;code&gt;foo.cc&lt;/code&gt;). Then type in this command&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$&amp;gt; g++ -M foo.cc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The output is a list of all the files that are included by the source
file, including standard library headers. If you look closer, the output
is formatted so that it follows the same syntax as &lt;code&gt;make&lt;/code&gt; for declaring
dependencies. But we really don&amp;rsquo;t want to be bothered with system header
files, so instead, we&amp;rsquo;ll use the &lt;code&gt;g++ -MM&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Cool, isn&amp;rsquo;t it? This means that all we now need to do is to find a way
to include this information in our Makefile, and have it automatically
update any time the source files are changed. So here&amp;rsquo;s the recipe.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-makefile&#34; data-lang=&#34;makefile&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# List of source files here.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;sources &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; foo.cc bar.cc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Add C++ flags, for example, if the code uses C++11 standards.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;CPPFLAGS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -std&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;c++11
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Recipe for making .d files from .cc files
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;%.d&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; %.cc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -MM &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CPPFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -o $@ $&amp;lt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Include the required .d files in the current Makefile.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;include $(sources&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;.cc=.d)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Recipe for making .o files. Here, I introduce a dependency on the
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# primary source c++ file.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;%.o&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; %.cc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -c &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CPPFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -o $@ &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;&amp;lt;:.d&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;.cc&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Of course, there&amp;rsquo;s a bug in this recipe as well. Can you spot it?&lt;/p&gt;
&lt;p&gt;The bug is that the &lt;code&gt;.d&lt;/code&gt; files do not update if something changes in the
include chain. However, the GNU Make manual has &lt;a href=&#34;https://www.gnu.org/software/make/manual/make.html#Generating-Prerequisites-Automatically&#34;&gt;an interesting
fix&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Their solution is to use &lt;code&gt;sed&lt;/code&gt; to introduce the same dependency chain as
for the &lt;code&gt;.o&lt;/code&gt; file into the &lt;code&gt;.d&lt;/code&gt; file. Here&amp;rsquo;s the updated Makefile with
their recipe.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-makefile&#34; data-lang=&#34;makefile&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# List of source files here.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;sources &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; foo.cc bar.cc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Add C++ flags, for example, if the code uses C++11 standards.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;CPPFLAGS &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; -std&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;c++11
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Recipe for making .d files from .cc files. This has been updated from
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# the GNU Make manual
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;%.d&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; %.cc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -MM &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CPPFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; $&amp;lt; &amp;gt; $@.$$$$; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	sed &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;s,\($*\)\.o[ :]*,\1.o $@ : ,g&amp;#39;&lt;/span&gt; &amp;lt; $@.$$$$ &amp;gt; $@; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	rm -f $@.$$$$
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Include the required .d files in the current Makefile.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;include $(sources&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;.cc=.d)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Recipe for making .o files. Here, I introduce a dependency on the
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# primary source c++ file.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;%.o&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; %.cc
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CC&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -c &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;CPPFLAGS&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt; -o $@ &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;&amp;lt;:.d&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;.cc&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Okay, I think that should work now. But it does beg the question, why
are we even writing Makefiles by hand any more? Shouldn&amp;rsquo;t we just use a
configuration system like CMake or GNU Autotools that can generate
correct Makefiles?&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Net Neutrality</title>
      <link>https://skandhurkat.com/post/net-neutrality/</link>
      <pubDate>Wed, 12 Jul 2017 09:04:44 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/net-neutrality/</guid>
      <description>&lt;p&gt;Today, my website displays a banner to join the fight for an open
internet. My message to the FCC follows.&lt;/p&gt;
&lt;p&gt;The FCC&amp;rsquo;s Open Internet Rules (net neutrality rules) are extremely
important to me. I urge you to protect them.&lt;/p&gt;
&lt;p&gt;As a person who is not an American citizen, I was led to believe
(perhaps wrongly) that America as a capitalist society would value the
very principles that allow a free market to function, namely a free flow
of information and healthy competition. It seems that I was mistaken.&lt;/p&gt;
&lt;p&gt;The proposed changes to the FCC rules negatively impact both these
principles. The internet is the epitome of a free flow of information,
however misunderstood it may be amongst those who make laws. A free and
open internet is one where all data is treated equal, and ISPs and cable
companies cannot distinguish between any kind of traffic. They should
not be allowed to create fast lanes or zero-rate some form of traffic.&lt;/p&gt;
&lt;p&gt;The creation of fast lanes or zero-rating some traffic while charging
for other forms of traffic goes against the spirit of free competition
in the market. It means that no one could create the next Google or
NetFlix unless they can get ISPs on board with their plan and provide
their traffic with the same high speed or low cost. It means that ISPs
will have ultimate control, not just of their own market (which, as I
shall discuss next is a monopoly), but also of other markets far removed
from the internet.&lt;/p&gt;
&lt;p&gt;Today, almost everything runs on networked computers. Any system that
must work across the width of a continent, or across multiple cities
uses the internet in some way or the other to communicate information
across. Even our phone lines are now increasingly routed over the
internet, using VoIP technology. Our light bulbs and toaster ovens will
soon use the internet as IoT becomes ubiquitous. So, support for net
neutrality is not just a fight for the internet; absence of net
neutrality and putting ISPs in position as gatekeeper would harm not
just internet services, but could extend to the physical world as well,
as the gap between physical and virtual worlds gets shorter and shorter.
We must ask: what gives ISPs the right to decide what works and what
doesn&amp;rsquo;t?&lt;/p&gt;
&lt;p&gt;The sooner lawmakers realise this fundamental truth, the better. &lt;strong&gt;ISPs
do not own the internet. They have not created the infrastructure for
the internet. They have done nothing other than create a monopoly that
taxes people to access a technology that was the product of taxpayer
dollars and DARPA research.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Indeed, ISPs are a monopoly in the USA. Right now, if I want internet
access, I have only one option, Time Warner, now called Spectrum. If I
lived in Pittsburgh, I would have only one option, Comcast. Monopolies
are antithetical to the free market. But I don&amp;rsquo;t need to tell you that.
A capitalist society should balk at the very idea of a monopoly. Yet,
lawmakers seem to accept and deny the very existence of these monopolies
in almost all facets of American life, rather than fulfil their role as
regulators and regulate the industries with monopolies to serve the very
people who elect them into office and not the industry lobbyists who pay
them money.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;If my country &amp;ndash; India &amp;ndash; could enact strong net neutrality
protections at a point in its history when ubiquitous internet access
was (and is) still not widespread throughout the country, I&amp;rsquo;m surprised
that the country that gave the world the free internet is now so eager
to destroy it to serve the interests of a small group of cable companies
that had nothing to do with the creation of the internet, and through
sheer coincidence ended up controlling everyone&amp;rsquo;s access to taxpayer
funded technology.&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>My thoughts on ISCA 2017</title>
      <link>https://skandhurkat.com/post/thoughts-isca-2017/</link>
      <pubDate>Thu, 29 Jun 2017 17:28:43 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/thoughts-isca-2017/</guid>
      <description>&lt;p&gt;I&amp;rsquo;m back from the 44&lt;sup&gt;th&lt;/sup&gt; International Symposium on Computer
Architecture, and this is a perfect time for me to summarise my thoughts
on the conference.&lt;/p&gt;
&lt;p&gt;The conference was in Toronto, which was a refreshing change for me to
see correct spelling and sensible units for a change. Beyond that, the
conference had a lot of interesting developments, and some that were not
quite as interesting.&lt;/p&gt;
&lt;p&gt;First, let me address the 15-month elephant in the room. That&amp;rsquo;s Google&amp;rsquo;s
Tensor processing unit (TPU) paper. I wasn&amp;rsquo;t impressed with the paper
(although I am impressed by the engineering), although a lot of people
seemed to be impressed by that paper. Indeed, only one other person I
spoke with at the conference seemed to share my views on the matter. My
criticism of the TPU paper is that it really gives little information.
An application-specific integrated circuit (ASIC) will obviously have
much less power/energy and much higher performance over a general
purpose processor. The really interesting parts of the TPU would have
been the Tensorflow-to-control-instructions compiler and driver.
Unfortunately, these details still remain elusive. In fact, the whole
paper describes (or fails to describe) technology that is over four
years old and has already been replaced. In my opinion, I find more
information in Google&amp;rsquo;s &lt;a href=&#34;https://googleprojectzero.blogspot.com/&#34;&gt;Project
Zero&lt;/a&gt; blog than I did in the
TPU paper and the associated talk.&lt;/p&gt;
&lt;p&gt;Which brings me to the next bit. ISCA had a &amp;lsquo;Trends in Machine Learning&amp;rsquo;
workshop, which I found as, if not more interesting than the main
conference. There were some really cool demos, such as real-time neural
networks running on embedded devices such as an iPhone and a Raspberry
Pi, &amp;lsquo;&lt;a href=&#34;https://clinc.com/&#34;&gt;Clinc&lt;/a&gt;&amp;rsquo;,
which can process natural speech and respond to queries on your
finances, DeepSpeech by Baidu, amongst others. The trend towards machine
learning was apparent even through the main program, with multiple
papers on accelerating neural networks.&lt;/p&gt;
&lt;p&gt;Just like any other conference, there were also some presentations that
had me completely zoned out. There were some that felt just like a
rehash of old ideas, and some which left me scratching my head.&lt;/p&gt;
&lt;p&gt;The overarching theme of the keynotes and the panel discussion, however,
were on the inevitable end of Moore&amp;rsquo;s law, with Mark Bohr from Intel
claiming that the law was merely tired and shagged out after a long
squawk, with plots showing that the number of transistors are indeed
doubling as expected from Moore&amp;rsquo;s law. Partha Ranganathan from Google,
on the other hand pointed out that the law had joined the choir
invisible. Partha argued that this was indeed a fun time to be an
architect, to talk to those annoying people working with software to
co-design hardware and software with the point of unlocking more
potential.&lt;/p&gt;
&lt;p&gt;In fact, if there is one message that I would take away from the
conference, it is that we computer architects have to fundamentally
change the way we look at our job. For years, computer architects were
perfectly happy using the extra transistors that the devices folks gave
us to make faster computers, and the evil people working in software
would take away this performance through even more bloated software.
Now, the pipeline has dried up, the devices people are not able to give
us faster and smaller transistors, and they definitely cannot give us
more power-efficient transistors because Dennard scaling is almost
certainly dead. As a result, we architects have to find ways to use
these transistors more efficiently. This means talking to the software
gremlins, understanding their evil algorithms and implementing them in
beautiful silicon. The future is almost certainly in going green by
reducing our power requirements and in grudgingly enabling the software
people to unlock greater functionality, not by relying on faster
computers, but by relying on custom, bespoke hardware that can run their
algorithms in an efficient manner.&lt;/p&gt;
&lt;p&gt;How such bespoke hardware should be deployed remains a challenge. We can
almost certainly not sell chips for mobile phones with the area of a
football field with billions of custom accelerators that are almost
always turned off except for a few running a custom app. My opinion is
that the best way to deploy these accelerators in the present moment is
in datacentres, to provide them to users as a service. Google is already
making great headway by allowing people to &lt;em&gt;rent&lt;/em&gt; cloud machines with
TPUs (I still dislike the TPU paper &amp;#x1f604;) and to use TensorFlow to
accelerate their workloads. I could envision cloud providers allowing
people to time-multiplex multiple accelerators in some sort of
mutual-fund or &lt;a href=&#34;https://www.massdrop.com/&#34;&gt;Massdrop&lt;/a&gt; like cloud service.&lt;/p&gt;
&lt;p&gt;Or maybe the future is in taking a step back and rethink our obsession
with Von Neumann machines with variants of the five-stage pipeline and
redraw our computers from scratch. I think it&amp;rsquo;s an exciting time to be
an architect, and also scary. As a PhD candidate, I have to try really
hard to look at the exciting bits and not the scary ones. &amp;#x1f604;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>An Introduction to CTest</title>
      <link>https://skandhurkat.com/post/intro-to-ctest/</link>
      <pubDate>Thu, 22 Jun 2017 11:05:43 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/intro-to-ctest/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve seen a lot of people (I&amp;rsquo;m looking at you &lt;a href=&#34;https://skandhurkat.com/&#34;&gt;Daniel
Lemire&lt;/a&gt;) praise newer languages like &lt;em&gt;Go&lt;/em&gt;, which makes me
sad as a C++ programmer. Well, that&amp;rsquo;s until I realise that most of the
features touted could be easily incorporated in C++ with just a bit of
elbow grease. In this post, I&amp;rsquo;ll show how to add an automated testing
system using CTest.&lt;/p&gt;
&lt;p&gt;I love &lt;a href=&#34;https://skandhurkat.com/&#34;&gt;CMake&lt;/a&gt;, it allows me to &lt;a href=&#34;https://skandhurkat.com/post/autohell-v-cmake/&#34;&gt;write cross-platform&lt;/a&gt; code and be &lt;a href=&#34;https://skandhurkat.com/post/why-i-like-cpp11/&#34;&gt;confident that the
build system would work across a choice of compilers, IDEs, and
operating systems&lt;/a&gt;. When
writing large projects, however, it is imperative to have a series of
tests that could indicate regression bugs whenever new features are
added. While I love the testing support built into languages such as
Java, writing tests is not all that hard in C++ either. For example, I
could simply write a function that mimics a unit test and prints out
either &amp;ldquo;Test passed&amp;rdquo; or &amp;ldquo;Test failed&amp;rdquo; depending on the result of the
test. All I now need is a way to automatically run these tests.&lt;/p&gt;
&lt;p&gt;This is where CTest comes into the picture. I&amp;rsquo;m assuming here that you
are using CMake as your build system. If you are not, then you are
clearly wrong, a terrible person, and the type who would probably not
write tests anyway. So stop reading this post. &amp;#x1f604;&lt;/p&gt;
&lt;p&gt;Okay, back from that little digression.&lt;/p&gt;
&lt;p&gt;My setup for testing is thus: I am building a library that defines all
the required functions. Each class/function/API must be tested, so I
write tests for each of these. The tests are written so that they would
indicate success using the keyword &amp;ldquo;Test passed&amp;rdquo; or failure using the
keyword &amp;ldquo;Test failed&amp;rdquo;. I put all the tests in a separate &lt;code&gt;tests&lt;/code&gt; folder.
Within the tests folder, I write my &lt;code&gt;CMakeLists.txt&lt;/code&gt; thus.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cmake&#34; data-lang=&#34;cmake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;set(&lt;span style=&#34;color:#e6db74&#34;&gt;EXECUTABLE_OUTPUT_PATH&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_BINARY_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/tests&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;set(&lt;span style=&#34;color:#e6db74&#34;&gt;CTEST_BINARY_DIRECTORY&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_BINARY_DIR&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/tests&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;file(&lt;span style=&#34;color:#e6db74&#34;&gt;GLOB&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;files&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;test_*.cc&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;foreach(&lt;span style=&#34;color:#e6db74&#34;&gt;file&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;files&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;	string(&lt;span style=&#34;color:#e6db74&#34;&gt;REGEX&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;REPLACE&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(^.*/|\\.[^.]*$)&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;file_without_ext&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;	add_executable(&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file_without_ext&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;	target_link_libraries(&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file_without_ext&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;PROJECT_LIBS&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;	add_test(&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file_without_ext&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file_without_ext&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;	set_tests_properties(&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file_without_ext&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#e6db74&#34;&gt;PROPERTIES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#e6db74&#34;&gt;PASS_REGULAR_EXPRESSION&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Test passed&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;	set_tests_properties(&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file_without_ext&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#e6db74&#34;&gt;PROPERTIES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#e6db74&#34;&gt;FAIL_REGULAR_EXPRESSION&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(Exception|Test failed)&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;	set_tests_properties(&lt;span style=&#34;color:#f92672&#34;&gt;${&lt;/span&gt;file_without_ext&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#e6db74&#34;&gt;PROPERTIES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#e6db74&#34;&gt;TIMEOUT&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;120&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&lt;/span&gt;endforeach()&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This is a really simple script. It loops over all files in the tests
folder that match the pattern &lt;code&gt;test_*.cc&lt;/code&gt;, i.e.\ C++ files that start
with the &lt;code&gt;test_&lt;/code&gt; prefix. It generates the executable name by stripping
out all the leading directories until the path, while also stripping out
the extension for the file. It compiles the file and links it against
the project libraries. Finally, it tells CMake/CTest that the compiled
binary is a test which on passing would have in its output the text
&amp;ldquo;Test passed&amp;rdquo;, and on failure could have the text &amp;ldquo;Test failed&amp;rdquo; or
&amp;ldquo;Exception&amp;rdquo;. Finally, I add a timeout of 120 seconds, or two minutes. If
the test runs longer than this time, it will be automatically terminated
and marked as a failure. This is not ideal &amp;ndash; some of my tests run for
just seconds, while the longest test could run for just under a minute.
However, the purpose of the timeout here is not to detect performance
bugs, rather to prevent the machine running the tests from fritzing out
because of a bug that results in the tests doing something really crazy.&lt;/p&gt;
&lt;p&gt;Oh, and in order to enable testing, I simply change the &lt;code&gt;CMakeLists.txt&lt;/code&gt;
on the very top level of the project (the one that defines project name,
version, etc.) to include this one extra line.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cmake&#34; data-lang=&#34;cmake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;include(&lt;span style=&#34;color:#e6db74&#34;&gt;CTest&lt;/span&gt;)&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Simple, isn&amp;rsquo;t it? Now why would you go running to &lt;em&gt;Go&lt;/em&gt; (see what I did
there? &amp;#x1f604;), when C++ with CMake offers cross platform builds,
testing infrastructure, and parallel execution with memory consistency
models?&lt;/p&gt;
&lt;p&gt;In the next posts on the series, I might just describe how to test for
memory leaks using Valgrind/MemCheck or how to test test-coverage
(alliteration FTW) using gcov. Stay tuned.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>An Introduction to Vim Macros</title>
      <link>https://skandhurkat.com/post/intro-to-vim-macros/</link>
      <pubDate>Sun, 04 Jun 2017 15:33:09 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/intro-to-vim-macros/</guid>
      <description>&lt;p&gt;Vim is my favourite text editor, because it is minimalist while also
being insanely configurable. While I may describe my ideal Vim setup
sometime in the future, I do want to share some tips and tricks that
make Vim so damn efficient for certain tasks. Today, I shall focus on
macros.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the key idea to keep in mind when discussing about Vim. Vim is
not just an editor, it is a text manipulation program. Inserting text is
just one of the many tasks that Vim can accomplish. A macro is a small
Vim program that the user can record in order to make text editing more
efficient.&lt;/p&gt;
&lt;p&gt;Consider a simple use case. Let&amp;rsquo;s say that I have a CSV file that looks
like this&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;New York,NY,USA
Seattle,WA,USA
Mumbai,MH,India
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Let&amp;rsquo;s say that I want to add another column at the beginning of each
line that is sequentially numbered, like so&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;1,New York,NY,USA
2,Seattle,WA,USA
3,Mumbai,MH,India
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I could go down each line and manually add each column, but there&amp;rsquo;s a
better way. The solution is to program a Vim macro that does the
following tasks in order.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Assuming that the first column of a certain line is the required
number for this line (row), we copy the first column to the next
line.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Increment the line number by one so that it is one more than the
previous line (row).&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So, I edit the first line, in order to manually add the new column to
the first line.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;1,New York,NY,USA
Seattle,WA,USA
Mumbai,MH,India
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Next, I ensure that I&amp;rsquo;m not executing any Vim command. I can verify this
by pressing &lt;kbd&gt;ESC&lt;/kbd&gt; a couple of times. Then I press &lt;kbd&gt;q&lt;/kbd&gt;
followed by a letter to identify this macro, e.g.: &lt;kbd&gt;a&lt;/kbd&gt;. The
macro then consists of the following keystrokes&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;kbd&gt;0&lt;/kbd&gt;: Move to the beginning of the line.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;v&lt;/kbd&gt;: Visual mode.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;/&lt;/kbd&gt;&lt;kbd&gt;,&lt;/kbd&gt;: Find the first &lt;code&gt;,&lt;/code&gt; to match.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;y&lt;/kbd&gt;: Yank (copy) the highlighted text.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;j&lt;/kbd&gt;&lt;kbd&gt;0&lt;/kbd&gt;: Go to the beginning of the next line.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;P&lt;/kbd&gt;: Paste the copied text. At this point, the cursor should
be on the &lt;code&gt;,&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;h&lt;/kbd&gt;: Move the cursor one position to the left so that it is
on the last digit of the number.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;Ctrl&lt;/kbd&gt;&lt;kbd&gt;a&lt;/kbd&gt;: Increment the number.&lt;/li&gt;
&lt;li&gt;&lt;kbd&gt;q&lt;/kbd&gt;: Stop recording the macro.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Now, pressing &lt;kbd&gt;@&lt;/kbd&gt;&lt;kbd&gt;a&lt;/kbd&gt; would perform the nine steps
outlined with just two key-presses. Let&amp;rsquo;s say the file had 50 more lines
to be edited. In this case, I could use another powerful trick that Vim
offers &amp;ndash; the ability to repeat a command multiple times. So, ensure
that I&amp;rsquo;m out of executing any command, I could type in a number followed
by a command that would execute the specified command a certain number
of times. So, pressing &lt;kbd&gt;5&lt;/kbd&gt;&lt;kbd&gt;0&lt;/kbd&gt;&lt;kbd&gt;@&lt;/kbd&gt;&lt;kbd&gt;a&lt;/kbd&gt;
would execute the macro &lt;code&gt;a&lt;/code&gt; fifty times, which is an insanely powerful
technique for modifying multiple lines with a single command.&lt;/p&gt;
&lt;p&gt;That&amp;rsquo;s all for Vim macros for today. I hope you found this post useful.
Macros were one of the things I learnt relatively late as a Vim user,
but now that I do know about this trick, I use it all the time, and it
has saved me countless hours and a lot of headache when modifying code
or text. Until the next time, when I take some time to write some more
about cool Vim tricks and tips.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>A bug in how GCC handles constructors</title>
      <link>https://skandhurkat.com/post/gcc-constructor-bug/</link>
      <pubDate>Tue, 23 May 2017 10:51:42 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/gcc-constructor-bug/</guid>
      <description>&lt;p&gt;Some days ago, I became aware of &lt;a href=&#34;https://akrzemi1.wordpress.com/2017/04/27/a-serious-bug-in-gcc/&#34;&gt;a bug in
GCC&lt;/a&gt;
that has apparently existed since 2015. As this is a bug that deals with
memory leaks, it is fairly serious.&lt;/p&gt;
&lt;p&gt;In this case, I really don&amp;rsquo;t want to re-post the entire content of the
source, so I will only list my experiments with reproducing the bug once
I became aware of it.&lt;/p&gt;
&lt;p&gt;C++ assumes that if a constructor fails, then no memory is allocated for
the object at all. This means that if a nested object was constructed,
C++ will implicitly call the destructor for that object so that the
programmer does not have to worry about partially constructed states.
This bug in GCC exists because under certain circumstances, GCC fails
this assumption.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s start off with a simple example trying to reproduce this bug.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;exception&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;inner&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; array;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner() &lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; array(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;inner constructed&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner(&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; inner&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; other) &lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; array(other.array)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;inner copy constructed&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;inner()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#66d9ef&#34;&gt;delete&lt;/span&gt;[] array;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;inner destructed&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;inner &lt;span style=&#34;color:#a6e22e&#34;&gt;make_inner_1&lt;/span&gt;() {&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; inner();}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;inner &lt;span style=&#34;color:#a6e22e&#34;&gt;make_inner_2&lt;/span&gt;() {&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;runtime_error(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;exception&amp;#34;&lt;/span&gt;);}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;outer&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner i1;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner i2;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		outer o{make_inner_1(), make_inner_2()};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;exception&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; e) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Abort after exception &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; e.what() &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Upon compiling and running this code, the output is&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;inner constructed
inner destructed
Abort after exception exception
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This behaviour is as is expected given C++ standards. The constructor
for object &lt;code&gt;outer&lt;/code&gt; tries to construct &lt;code&gt;i1&lt;/code&gt;, succeeds, then tries to
construct &lt;code&gt;i2&lt;/code&gt;, fails, and destructs &lt;code&gt;i1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Well, what if we try to create a nameless temporary object?&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;exception&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;inner&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; array;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner() &lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; array(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;inner constructed&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner(&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; inner&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; other) &lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; array(other.array)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;inner copy constructed&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;inner()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#66d9ef&#34;&gt;delete&lt;/span&gt;[] array;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;inner destructed&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;inner &lt;span style=&#34;color:#a6e22e&#34;&gt;make_inner_1&lt;/span&gt;() {&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; inner();}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;inner &lt;span style=&#34;color:#a6e22e&#34;&gt;make_inner_2&lt;/span&gt;() {&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;runtime_error(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;exception&amp;#34;&lt;/span&gt;);}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;outer&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner i1;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	inner i2;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;foo&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	outer o;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		foo{outer({make_inner_1(), make_inner_2()})};
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;exception&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; e) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;cout &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Abort after exception &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; e.what() &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;endl;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In this case, the output is&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;inner constructed
Abort after exception exception
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This introduces a memory leak, because while &lt;code&gt;i1&lt;/code&gt; is constructed, it is
never destroyed. If I compile using clang (version 3.8.0-2ubuntu4), the
expected output is still correct.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;inner constructed
inner destructed
Abort after exception exception
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The fact that this bug has remained unresolved for over two years is
surprising. At this point, I&amp;rsquo;m tempted to point out a paper by Ken
Thompson, &lt;em&gt;&lt;a href=&#34;https://doi.org/10.1145/358198.358210&#34;&gt;Reflections on trusting
trust&lt;/a&gt;&lt;/em&gt;, which points out that an
untrustworthy compiler could introduce a bug in all or a few select
programs that it compiles. Moreover, the compiler could be engineered to
introduce a bug in its own binary, so compiling the compiler from source
wouldn&amp;rsquo;t help either.&lt;/p&gt;
&lt;p&gt;This is a subtle bug that took me some time to reproduce. However, I can
easily imagine how frustrating it could be if this bug were to manifest
in a larger program that would show up through the use of &lt;code&gt;memcheck&lt;/code&gt; or
a similar tool. In the meanwhile, we cannot do much except wait for a
patch. This bug hasn&amp;rsquo;t shown up yet in code I&amp;rsquo;ve written, but I can
always switch my build system to clang/Makefiles (the joys of &lt;a href=&#34;https://skandhurkat.com/post/why-i-like-cpp11/&#34;&gt;writing
platform-independent code&lt;/a&gt;
with &lt;a href=&#34;https://skandhurkat.com/post/autohell-v-cmake/&#34;&gt;CMake as a build system&lt;/a&gt;).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>X forwarding on Docker</title>
      <link>https://skandhurkat.com/post/x-forwarding-on-docker/</link>
      <pubDate>Tue, 25 Apr 2017 16:21:47 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/x-forwarding-on-docker/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://skandhurkat.com/&#34;&gt;Mark Buckler&lt;/a&gt; and I use Docker a lot.
Sometimes, we need X11 forwarding to work over SSH. Here&amp;rsquo;s a summary of
the steps involved in case you&amp;rsquo;re curious.&lt;/p&gt;
&lt;h3 id=&#34;edit-the-docker-file&#34;&gt;Edit the Docker file&lt;/h3&gt;
&lt;p&gt;Add these lines:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RUN apt-get update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RUN apt-get install -qqy x11-apps
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This installs the necessary X packages on the Docker image.&lt;/p&gt;
&lt;h3 id=&#34;run-this-once-per-ssh-session&#34;&gt;Run this once per SSH session&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;XAUTH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$HOME/.Xauthority
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;touch $XAUTH
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This code sets the path to the &lt;code&gt;.Xauthority&lt;/code&gt; file. When using SSH with
X11 forwarding, the &lt;code&gt;.Xauthority&lt;/code&gt; file is automatically created in the
user&amp;rsquo;s &lt;code&gt;$HOME&lt;/code&gt; folder. If not using X11 forwarding (for instance, when
operating locally on the machine), &lt;code&gt;touch&lt;/code&gt; will create the &lt;code&gt;.Xauthority&lt;/code&gt;
file.&lt;/p&gt;
&lt;h3 id=&#34;start-the-docker-image&#34;&gt;Start the Docker image&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;docker run --tty --interactive --network&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;host --env DISPLAY&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;$DISPLAY --volume $XAUTH:/root/.Xauthority &amp;lt;dockerimagename&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This starts a Docker image with a TTY, in interactive mode, using the
host&amp;rsquo;s networking stack (i.e. the container and the host are identical
in their network usage, so port XX in the container is port XX on the
host. It also exports the &lt;code&gt;$DISPLAY&lt;/code&gt; environment variable to Docker, and
binds the &lt;code&gt;.Xauthority&lt;/code&gt; file (on the host) to the root user within the
container.&lt;/p&gt;
&lt;p&gt;That&amp;rsquo;s all folks! I suspect that these instructions will also be
cross-posted on Mark&amp;rsquo;s website. You should absolutely follow his
&lt;a href=&#34;https://skandhurkat.com/post/&#34;&gt;blog&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>PSA: Don&#39;t use std::rand()</title>
      <link>https://skandhurkat.com/post/psa-dont-use-rand/</link>
      <pubDate>Sun, 16 Apr 2017 19:50:51 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/psa-dont-use-rand/</guid>
      <description>&lt;p&gt;With the &lt;code&gt;&amp;lt;random&amp;gt;&lt;/code&gt; header in C++11 onwards, there really is no reason
to use &lt;code&gt;std::rand()&lt;/code&gt; to generate random numbers. In fact, using
&lt;code&gt;std::rand()&lt;/code&gt; could be really harmful.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;std::rand()&lt;/code&gt; generates random numbers using a linear congruential
engine. This is a simple formula &amp;ndash; $x_{n+1} = (a x_n + b) \mod c$. The
trouble with such a simple engine is that the numbers generated have
very low entropy.&lt;/p&gt;
&lt;p&gt;But I really don&amp;rsquo;t care about entropy, it&amp;rsquo;s not like I&amp;rsquo;m writing a
cryptography application, you say? Well, let me tell you a cautionary
tale about how using &lt;code&gt;std::rand()&lt;/code&gt; sent me on a wild goose chase for
over a week trying to hunt down a bug miles from where it really was.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the story. I was writing a piece of code that was supposed to
return events at a random time, somewhere between &lt;code&gt;x&lt;/code&gt; and &lt;code&gt;y&lt;/code&gt; cycles in
the future. I did not really care that the random numbers generated were
&lt;em&gt;good&lt;/em&gt;, I just wanted something quick and dirty. So, I ended up using
code that looked like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;time_type new_event_time &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; get_current_time() &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; (std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;rand() &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; (y &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; x)) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; x;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Looks good, and behaved reasonably well for almost all the test cases I
threw at the problem. However, one specific test case was really
sensitive to the order in which events returned, but only if the number
of pending events was larger than a certain number &lt;code&gt;z&lt;/code&gt;. This test
started to fail, as is to be expected. However, the failures happened a
great deal into the future, which suggested some weird errors in
bookkeeping that would manifest after a certain number of insertions and
deletions. This forced me to go on a bug-hunting spree that revealed
absolutely nothing. Then, I discovered a &lt;a href=&#34;//channel9.msdn.com/Events/GoingNative/2013/rand-Considered-Harmful&#34;&gt;talk by
STL&lt;/a&gt;,
which is the inspiration for this post as well. In this talk, STL shows
how bad the linear congruential engine in the &lt;code&gt;std::rand()&lt;/code&gt; function
really is.&lt;/p&gt;
&lt;p&gt;So, I simply replaced the random number generation code. The
&lt;code&gt;std::srand()&lt;/code&gt; equivalent code is&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;random_device rd;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;mt19937 mt(rd());
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;uniform_int_distribution dist(x, y);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and the equivalent code for&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;time_type new_event_time &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; get_current_time() &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; (std&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;rand() &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; (y &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; x)) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; x;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;simplifies to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;time_type new_event_time &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; get_current_time() &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; dist(mt);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Simple, isn&amp;rsquo;t it? With this new piece of code, my test began to fail
much earlier, which prompted me to discover the real source of the bug.&lt;/p&gt;
&lt;p&gt;I was intimidated by the new C++11 random number generation library
because it requires the creation of a random device, a pseudo-random
engine and a distribution, which is three more than a call to
&lt;code&gt;std::rand()&lt;/code&gt;. However, the low quality of &lt;code&gt;std::rand()&lt;/code&gt; makes it
unsuitable for even the simplest tasks requiring random numbers. My
advice is, don&amp;rsquo;t ever use &lt;code&gt;std::rand()&lt;/code&gt; and think you can get away with
it.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Cornell Graduate Students United: At what cost?</title>
      <link>https://skandhurkat.com/post/cgsu-at-what-cost/</link>
      <pubDate>Sat, 25 Mar 2017 17:56:19 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/cgsu-at-what-cost/</guid>
      <description>&lt;p&gt;On Monday and Tuesday, we graduate students at Cornell will be voting on
whether or not we want to unionise. Actually, scratch that, only
graduate students who hold a TA, RA, or GRA appointment can unionise.&lt;/p&gt;
&lt;p&gt;This is a shitty arrangement, and I will be voting against it.&lt;/p&gt;
&lt;p&gt;For those of you who are not aware of how graduate school works at
Cornell, you could be on one of many appointments.&lt;/p&gt;
&lt;dl&gt;
&lt;dt&gt;Fellowship&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;A graduate student on a fellowship gets a stipend and tuition paid
without associated teaching or research opportunities. Graduate students
on a fellowship typically work towards their own theses, but will be
excluded from the union&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;Graduate research assistantships&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;A GRA gives a graduate student stipend and tuition without teaching
responsibilities. However, this money comes out of a specific project
grant, and the students typically work on their own theses. Students on
GRAs magically qualify to join the union, whereas there is virtually no
difference between a GRA and a fellowship for the most part.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;Research assistantships&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;An RA appointment provides stipend and tuition without teaching
responsibilities, but with research responsibilities. Students on an RA
appointment must work on projects that may not be their own theses. RAs
qualify to form a union&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;Teaching assistantships&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;A TA appointment provides stipend and tuition with teaching
responsibilities. TA appointments qualify to form a union.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;This breakdown shows that the union organisation is already on tenuous
ground, as students could move in and out of these various appointments
on a semester-by-semester basis. Receiving and losing union protection
every four months is like not receiving any protection at all. If the
union truly believes that students are exploited by professors (which I
must categorically state, I am not. I love my job, I love my lab, and I
love my advisor), then they are leaving a gaping loophole wherein a
professor could simply move a student out of one of the protected
appointments to an unprotected appointment, then crap all over them.&lt;/p&gt;
&lt;p&gt;But that&amp;rsquo;s not the primary reason I am opposed to the union. &lt;strong&gt;At every
stage in campaigning for our votes, the union has been shifty and
deceitful&lt;/strong&gt;, sometimes resorting to outright lies that could be easily
disproved. For instance, the union always brought up a case of a student
in the department of chemical engineering who lost his appointment at a
lab following an accident that allegedly left him unable to control his
right hand for a couple of years. The union&amp;rsquo;s position was, well, if
only there were a union to fight for workers&amp;rsquo; compensation, that student
would still be at Cornell. Here&amp;rsquo;s the lie &amp;ndash; &lt;strong&gt;students on a GRA, RA, or
TA are already protected by workers&amp;rsquo; compensation&lt;/strong&gt;. That particular
student was on a fellowship, and this underscores my point about the
shittiness of students receiving different protections for the same work
based on an arbitrary status. In this student&amp;rsquo;s case, the union would
have simply walked away with a &amp;lsquo;Not my problem&amp;rsquo; statement.&lt;/p&gt;
&lt;p&gt;Now, I am a fan of collective bargaining. I believe that we students may
still get a lot done through collective bargaining, but the union in its
current form is not the way to do so. For starters, the union will not
cover all graduate students, and I abhor the idea of leaving some fellow
students in virtually the same position as myself without the
protections of collective bargaining simply based on a technicality. But
this is ignoring the fact that Cornell has an organisation that could
achieve collective bargaining for graduate students, the Graduate and
Professional Students Assembly (GPSA), which has successfully managed to
achieve many things in Cornell, such as negotiating our wages to be
raised at 2% a year, above the current inflation rate of 1%. The last
president, Elizabeth Garrett also increased graduate student salaries
across the board, making RA and GRA salaries the same as TA salaries.
Now, asking us to put $500&amp;ndash;1000 towards union dues is stupid,
considering that we make $30,000 a year before state and federal income
taxes. What&amp;rsquo;s also crazy is that the union apparently will have a
two-tiered structure, wherein we may be expected to pay more in order to
have a vote (a voice) in the union. This is taxation without
representation, and I will always vote against such an arrangement on a
matter of principle.&lt;/p&gt;
&lt;p&gt;Additionally, the union seems like a power grab by a bunch of sloppy
students. The entire process was undemocratic to say the least, and
seemed just like a page out of Catch-22. Sign the union authorisation
card. Well, what am I signing up for? Come to our meetings and find out.
Cool, how do I do that? You must sign the card to come to our meetings.
The process was secret, with no voice from graduate students who may
have been on the fence, and with further amendments to artificially
inflate the voices of some students. Take, for instance, &lt;a href=&#34;https://cornellgsu.org/s/CGSUNegotiatingCommitteeConstitutionalAmendment.pdf&#34;&gt;this
amendment&lt;/a&gt;,
which grants equal voice on the negotiating committee to students from
the six jurisdictions, whereas the number of students in these
jurisdictions are by no means the same.&lt;/p&gt;
&lt;p&gt;Further, some of the provisions on the Cornell GSU constitution defy
logic, and show that they were probably written by monkeys on
typewriters. See, for instance, &lt;a href=&#34;https://cornellgsu.org/our-constitution/#IV.A.A2&#34;&gt;Section
IV.A.A2&lt;/a&gt;, which states
that any grievance against any member of the union will be shared across
all members of the union. I do not see this as helpful. While
transparency is good, it should be balanced with privacy. Publishing a
list of grievances without verification of the claims is irresponsible,
and promotes a lynch-mob mentality which will make the environment at
Cornell a lot more hostile and toxic. I realise that I am not providing
evidence to support this claim &amp;ndash; the fact is that I am basing this off
an existing incident which I do not wish to publicise, firstly, because
I heard this account second-hand, and in order to protect the privacy of
the persons that may have been involved.&lt;/p&gt;
&lt;p&gt;Lastly, the process of getting rid of a dysfunctional union will be
much, much harder than the process of voting one in. So, to my friends
who say that they want to &amp;rsquo;try it out&amp;rsquo;, let me remind them that this is
the equivalent of &amp;rsquo;trying out&amp;rsquo; arson. You will probably get burned, and
you&amp;rsquo;ll be leaving a whole future generation of graduate students with a
mess that they&amp;rsquo;ll have to deal with for the entirety of their graduate
student life.&lt;/p&gt;
&lt;p&gt;To conclude, the union in its current form is a juvenile power grab
without a stated objective, a mission, or a plan to achieve its
objectives. Voting for the union is the equivalent of voting for Donald
Trump, and I hope that my friends can now see how that&amp;rsquo;s working out for
the USA. Do not, do not vote for the union. Vote against it, let them
come up with something better instead of an empty promise for something
better. We can always vote for a better union next year. But we cannot
vote out a shitty union once it&amp;rsquo;s formed.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>A history of computing -- my perspective</title>
      <link>https://skandhurkat.com/post/history-of-computing/</link>
      <pubDate>Sat, 31 Aug 2013 17:46:37 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/history-of-computing/</guid>
      <description>&lt;p&gt;Because I can publish shitty drawings, and even shittier text.&lt;/p&gt;
&lt;p&gt;And I have no obligation to be accurate.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/01.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/02.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/03.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/04.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/05.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/06.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/07.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/08.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/09.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/10.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/11.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/12.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/13.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://skandhurkat.com/post/history-of-computing/14.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>On writing platform-independent code (or why I like the new C&#43;&#43;)</title>
      <link>https://skandhurkat.com/post/why-i-like-cpp11/</link>
      <pubDate>Sat, 16 Mar 2013 17:26:35 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/why-i-like-cpp11/</guid>
      <description>&lt;p&gt;I use Linux when I work from home, I&amp;rsquo;m forced to use a Mac at work
(well, I boot up a virtual Linux OS), and I use Windows when I just want
to goof around with my computer. So, while most of my work is done on
Linux, it&amp;rsquo;s imperative that my code work on all platforms; just because
I could use any of the three.&lt;/p&gt;
&lt;p&gt;Traditionally, C required multiple versions of code, protected by
&lt;code&gt;#ifdef&lt;/code&gt;s. This often required multiple versions of code to be written,
depending on the target system, target OS, and compiler being used.
Clumsy and messy system.&lt;/p&gt;
&lt;p&gt;C++ too had similar shortcomings. When it came to writing multi-threaded
code, I had to choose either Win32 or Posix, and once I made that
choice, I was bound by it. Since those were the days when Ubuntu was
driving me crazy, I chose Win32. Bad decision.&lt;/p&gt;
&lt;p&gt;Every single action that I attempted was compounded by the fact that
Win32 is the worst API ever. How do I lock a mutex? Well, first I
declare a handle, then declare a mutex, then define the handle to point
to the mutex, then attempt to lock the mutex, specifying a timeout
interval, then check to see if the error on the acquisition is
&lt;code&gt;ERROR_SUCCESS&lt;/code&gt;. A crazy system which leads to crazy code.&lt;/p&gt;
&lt;p&gt;And that&amp;rsquo;s not compatible with Posix, which is a much cleaner API.&lt;/p&gt;
&lt;p&gt;So, when C++11 was announced, I jumped with joy at the fact that
multi-threading support was built into the language, and that the
proposed interface was so much similar to the cleaner Posix API. C++11
allows me to get rid of the system dependent multi-threading APIs, and
focus on the code at hand that actually solves the problem. Not only
that, C++11 specifies memory models for atomic operations; which allows
me to atomically load, store and swap values. The only way this would be
possible prior to C++11 was to declare a mutex for every atomic
operation. Not a good idea, as it would lead to a tonne of mutexes, with
large, irrelevant scope.&lt;/p&gt;
&lt;p&gt;The other, messier option would be to dive down into the assembly level
of the target platform, and write in some assembly to atomically load or
store some values.&lt;/p&gt;
&lt;p&gt;Combine the improved multi-threading and memory models in C++11 with
CMake, and I get a nice cross platform code, which works on multiple
platforms; well, almost. To be really sure, I need to test the code on
each platform; but it&amp;rsquo;s relatively harder to mess up, the most chances
occur in CMake, where I need to define compiler options for different
build environments using a number of conditional statements. It&amp;rsquo;s worse,
because CMake is scripted, and that means that there may be conditions
which are written syntactically incorrect, but I would not be aware of
this until I actually tried to build on a system that leads to those
conditions. Still, CMake does not, or should not make a bulk of the
code.&lt;/p&gt;
&lt;p&gt;The usefulness of writing platform independent code was apparent when I
worked on &lt;a href=&#34;https://skandhurkat.com/project/emodetect/&#34;&gt;EmoDetect&lt;/a&gt;. I used Linux
(Ubuntu 12.04), Abhinandan used Mac and Ubuntu (12.10), and both Rishabh
and Aayush used Windows (different versions here). Yet, we could
collaborate perfectly (again, almost; the three of them had an
inexplicable aversion to git, so we ended up passing files (not just
patches (OMG!))).&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;d say that it&amp;rsquo;s so important to write platform independent code. I&amp;rsquo;ve
been trying (unsuccessfully) to port Darktable to Windows; and while I&amp;rsquo;m
sure that it would not be too much effort to port the actual DT code,
I&amp;rsquo;m stuck with compiling libraries, all of which were written for GNU,
and Windows support was added later as a hack. Some of them don&amp;rsquo;t
compile, many need to be fixed, and that&amp;rsquo;s holding up the process
indefinitely.&lt;/p&gt;
&lt;p&gt;That and the fact that I now almost always use Ubuntu, which means that
I don&amp;rsquo;t really bother about Windows software any longer.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>AutoHell v CMake</title>
      <link>https://skandhurkat.com/post/autohell-v-cmake/</link>
      <pubDate>Thu, 16 Aug 2012 17:24:18 -0400</pubDate>
      
      <guid>https://skandhurkat.com/post/autohell-v-cmake/</guid>
      <description>&lt;p&gt;People familiar with the GNU/Unix system would know that the standard
way to install about any GNU software from code is to run the following
commands&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;configure
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;make
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo make install
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;These commands are from the GNU autotools environment. Knowing the GNU
environment, these tools are what I used to compile most of the
(relatively small) pieces of code I wrote.&lt;/p&gt;
&lt;p&gt;Until I discovered CMake.&lt;/p&gt;
&lt;p&gt;CMake, or Cross-platform Make is a tool that serves the same
functionality as the GNU autotools (hereafter referred to as autohell).
As the name suggests, CMake can be used to compile software across
multiple platforms.&lt;/p&gt;
&lt;p&gt;Why am I encouraging CMake over autohell? Well, firstly, its not
autohell! The GNU autotools are extremely useful when compiling on
Linux. Thats what they are designed for. Cross compilation is extremely
easy with the &lt;code&gt;--host=&lt;/code&gt; flag. Unfortunately, when it comes to using them
on Windows, the system just becomes a pain in the neck.&lt;/p&gt;
&lt;p&gt;People who have tried to compile a GNU package on Windows would know
what Im speaking about. You type in configure, wait for about half an
hour while the script does its job in the MSYS terminal, then enter
&lt;code&gt;make -j4&lt;/code&gt; (to speed up the process), wait for an hour while libtool
compiles the bloody code, then &lt;code&gt;make install&lt;/code&gt; (finally!).&lt;/p&gt;
&lt;p&gt;The reason why the process is so painfully slow is that autotools, at
their heart are just shell scripts. This means that while compiling for
Windows, in an MSYS terminal, the shell script is parsed by sh.exe,
which is a slow emulator of the Unix shell. Further, when the configure
script has done its job, the Makefile takes over, which relegates all
compile operations to libtool, which is another bloody shell script.
More sh.exe calls! The result? A painfully slow compile and installation
process. Contrast that with CMake. Now, CMake exists on all platforms.
Its simple and elegant, and allows a choice of compilers, right from
MSYS Makefiles, to CodeBlocks MinGW projects, to Visual Studio project
files.&lt;/p&gt;
&lt;p&gt;To prove my point, Id just recommend that you checkout &lt;a href=&#34;http://github.com/skandhurkat/Just-For-Fun/tree/master/Library&#34;&gt;a simple
project&lt;/a&gt;
(Library management system, my 12th grade project) in my GitHub
repository, which can be compiled using autohell as well as CMake. The
CMake step takes a second, while autohell takes over a minute (on
Windows). Moreover, the CMakeLists.txt file is short and sweet, and was
written in under a minute. By contrast, I took ages to write autohell
files, what with configure.ac, Makefile.am and stuff. I switched from
autohell to CMake immediately.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
